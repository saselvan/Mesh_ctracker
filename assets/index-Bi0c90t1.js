(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();var he,F,tt,K,Ne,nt,rt,ot,Ee,we,ke,te={},st=[],Mt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,pe=Array.isArray;function J(e,t){for(var n in t)e[n]=t[n];return e}function xe(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Tt(e,t,n){var o,s,a,l={};for(a in t)a=="key"?o=t[a]:a=="ref"?s=t[a]:l[a]=t[a];if(arguments.length>2&&(l.children=arguments.length>3?he.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(a in e.defaultProps)l[a]===void 0&&(l[a]=e.defaultProps[a]);return se(e,l,o,s,null)}function se(e,t,n,o,s){var a={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++tt,__i:-1,__u:0};return s==null&&F.vnode!=null&&F.vnode(a),a}function Q(e){return e.children}function ae(e,t){this.props=e,this.context=t}function Z(e,t){if(t==null)return e.__?Z(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?Z(e):null}function at(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return at(e)}}function $e(e){(!e.__d&&(e.__d=!0)&&K.push(e)&&!ie.__r++||Ne!=F.debounceRendering)&&((Ne=F.debounceRendering)||nt)(ie)}function ie(){for(var e,t,n,o,s,a,l,c=1;K.length;)K.length>c&&K.sort(rt),e=K.shift(),c=K.length,e.__d&&(n=void 0,o=void 0,s=(o=(t=e).__v).__e,a=[],l=[],t.__P&&((n=J({},o)).__v=o.__v+1,F.vnode&&F.vnode(n),Ae(t.__P,n,o,t.__n,t.__P.namespaceURI,32&o.__u?[s]:null,a,s??Z(o),!!(32&o.__u),l),n.__v=o.__v,n.__.__k[n.__i]=n,ct(a,n,l),o.__e=o.__=null,n.__e!=s&&at(n)));ie.__r=0}function lt(e,t,n,o,s,a,l,c,u,d,h){var i,p,_,w,k,m,f,g=o&&o.__k||st,C=t.length;for(u=It(n,t,g,u,C),i=0;i<C;i++)(_=n.__k[i])!=null&&(p=_.__i==-1?te:g[_.__i]||te,_.__i=i,m=Ae(e,_,p,s,a,l,c,u,d,h),w=_.__e,_.ref&&p.ref!=_.ref&&(p.ref&&Me(p.ref,null,_),h.push(_.ref,_.__c||w,_)),k==null&&w!=null&&(k=w),(f=!!(4&_.__u))||p.__k===_.__k?u=it(_,u,e,f):typeof _.type=="function"&&m!==void 0?u=m:w&&(u=w.nextSibling),_.__u&=-7);return n.__e=k,u}function It(e,t,n,o,s){var a,l,c,u,d,h=n.length,i=h,p=0;for(e.__k=new Array(s),a=0;a<s;a++)(l=t[a])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=e.__k[a]=se(null,l,null,null,null):pe(l)?l=e.__k[a]=se(Q,{children:l},null,null,null):l.constructor==null&&l.__b>0?l=e.__k[a]=se(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):e.__k[a]=l,u=a+p,l.__=e,l.__b=e.__b+1,(d=l.__i=Nt(l,n,u,i))!=-1&&(i--,(c=n[d])&&(c.__u|=2)),c==null||c.__v==null?(d==-1&&(s>h?p--:s<h&&p++),typeof l.type!="function"&&(l.__u|=4)):d!=u&&(d==u-1?p--:d==u+1?p++:(d>u?p--:p++,l.__u|=4))):e.__k[a]=null;if(i)for(a=0;a<h;a++)(c=n[a])!=null&&!(2&c.__u)&&(c.__e==o&&(o=Z(c)),ut(c,c));return o}function it(e,t,n,o){var s,a;if(typeof e.type=="function"){for(s=e.__k,a=0;s&&a<s.length;a++)s[a]&&(s[a].__=e,t=it(s[a],t,n,o));return t}e.__e!=t&&(o&&(t&&e.type&&!t.parentNode&&(t=Z(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function Nt(e,t,n,o){var s,a,l,c=e.key,u=e.type,d=t[n],h=d!=null&&(2&d.__u)==0;if(d===null&&c==null||h&&c==d.key&&u==d.type)return n;if(o>(h?1:0)){for(s=n-1,a=n+1;s>=0||a<t.length;)if((d=t[l=s>=0?s--:a++])!=null&&!(2&d.__u)&&c==d.key&&u==d.type)return l}return-1}function Oe(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Mt.test(t)?n:n+"px"}function re(e,t,n,o,s){var a,l;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||Oe(e.style,t,"");if(n)for(t in n)o&&n[t]==o[t]||Oe(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")a=t!=(t=t.replace(ot,"$1")),l=t.toLowerCase(),t=l in e||t=="onFocusOut"||t=="onFocusIn"?l.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+a]=n,n?o?n.u=o.u:(n.u=Ee,e.addEventListener(t,a?ke:we,a)):e.removeEventListener(t,a?ke:we,a);else{if(s=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function Le(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=Ee++;else if(t.t<n.u)return;return n(F.event?F.event(t):t)}}}function Ae(e,t,n,o,s,a,l,c,u,d){var h,i,p,_,w,k,m,f,g,C,P,E,x,H,A,v,D,M=t.type;if(t.constructor!=null)return null;128&n.__u&&(u=!!(32&n.__u),a=[c=t.__e=n.__e]),(h=F.__b)&&h(t);e:if(typeof M=="function")try{if(f=t.props,g="prototype"in M&&M.prototype.render,C=(h=M.contextType)&&o[h.__c],P=h?C?C.props.value:h.__:o,n.__c?m=(i=t.__c=n.__c).__=i.__E:(g?t.__c=i=new M(f,P):(t.__c=i=new ae(f,P),i.constructor=M,i.render=Ot),C&&C.sub(i),i.state||(i.state={}),i.__n=o,p=i.__d=!0,i.__h=[],i._sb=[]),g&&i.__s==null&&(i.__s=i.state),g&&M.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=J({},i.__s)),J(i.__s,M.getDerivedStateFromProps(f,i.__s))),_=i.props,w=i.state,i.__v=t,p)g&&M.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),g&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(g&&M.getDerivedStateFromProps==null&&f!==_&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(f,P),t.__v==n.__v||!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(f,i.__s,P)===!1){for(t.__v!=n.__v&&(i.props=f,i.state=i.__s,i.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(U){U&&(U.__=t)}),E=0;E<i._sb.length;E++)i.__h.push(i._sb[E]);i._sb=[],i.__h.length&&l.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(f,i.__s,P),g&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(_,w,k)})}if(i.context=P,i.props=f,i.__P=e,i.__e=!1,x=F.__r,H=0,g){for(i.state=i.__s,i.__d=!1,x&&x(t),h=i.render(i.props,i.state,i.context),A=0;A<i._sb.length;A++)i.__h.push(i._sb[A]);i._sb=[]}else do i.__d=!1,x&&x(t),h=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++H<25);i.state=i.__s,i.getChildContext!=null&&(o=J(J({},o),i.getChildContext())),g&&!p&&i.getSnapshotBeforeUpdate!=null&&(k=i.getSnapshotBeforeUpdate(_,w)),v=h,h!=null&&h.type===Q&&h.key==null&&(v=dt(h.props.children)),c=lt(e,pe(v)?v:[v],t,n,o,s,a,l,c,u,d),i.base=t.__e,t.__u&=-161,i.__h.length&&l.push(i),m&&(i.__E=i.__=null)}catch(U){if(t.__v=null,u||a!=null)if(U.then){for(t.__u|=u?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;a[a.indexOf(c)]=null,t.__e=c}else{for(D=a.length;D--;)xe(a[D]);Se(t)}else t.__e=n.__e,t.__k=n.__k,U.then||Se(t);F.__e(U,t,n)}else a==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):c=t.__e=$t(n.__e,t,n,o,s,a,l,u,d);return(h=F.diffed)&&h(t),128&t.__u?void 0:c}function Se(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Se)}function ct(e,t,n){for(var o=0;o<n.length;o++)Me(n[o],n[++o],n[++o]);F.__c&&F.__c(t,e),e.some(function(s){try{e=s.__h,s.__h=[],e.some(function(a){a.call(s)})}catch(a){F.__e(a,s.__v)}})}function dt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:pe(e)?e.map(dt):J({},e)}function $t(e,t,n,o,s,a,l,c,u){var d,h,i,p,_,w,k,m=n.props||te,f=t.props,g=t.type;if(g=="svg"?s="http://www.w3.org/2000/svg":g=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),a!=null){for(d=0;d<a.length;d++)if((_=a[d])&&"setAttribute"in _==!!g&&(g?_.localName==g:_.nodeType==3)){e=_,a[d]=null;break}}if(e==null){if(g==null)return document.createTextNode(f);e=document.createElementNS(s,g,f.is&&f),c&&(F.__m&&F.__m(t,a),c=!1),a=null}if(g==null)m===f||c&&e.data==f||(e.data=f);else{if(a=a&&he.call(e.childNodes),!c&&a!=null)for(m={},d=0;d<e.attributes.length;d++)m[(_=e.attributes[d]).name]=_.value;for(d in m)if(_=m[d],d!="children"){if(d=="dangerouslySetInnerHTML")i=_;else if(!(d in f)){if(d=="value"&&"defaultValue"in f||d=="checked"&&"defaultChecked"in f)continue;re(e,d,null,_,s)}}for(d in f)_=f[d],d=="children"?p=_:d=="dangerouslySetInnerHTML"?h=_:d=="value"?w=_:d=="checked"?k=_:c&&typeof _!="function"||m[d]===_||re(e,d,_,m[d],s);if(h)c||i&&(h.__html==i.__html||h.__html==e.innerHTML)||(e.innerHTML=h.__html),t.__k=[];else if(i&&(e.innerHTML=""),lt(t.type=="template"?e.content:e,pe(p)?p:[p],t,n,o,g=="foreignObject"?"http://www.w3.org/1999/xhtml":s,a,l,a?a[0]:n.__k&&Z(n,0),c,u),a!=null)for(d=a.length;d--;)xe(a[d]);c||(d="value",g=="progress"&&w==null?e.removeAttribute("value"):w!=null&&(w!==e[d]||g=="progress"&&!w||g=="option"&&w!=m[d])&&re(e,d,w,m[d],s),d="checked",k!=null&&k!=e[d]&&re(e,d,k,m[d],s))}return e}function Me(e,t,n){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(s){F.__e(s,n)}}function ut(e,t,n){var o,s;if(F.unmount&&F.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||Me(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(a){F.__e(a,t)}o.base=o.__P=null}if(o=e.__k)for(s=0;s<o.length;s++)o[s]&&ut(o[s],t,n||typeof e.type!="function");n||xe(e.__e),e.__c=e.__=e.__e=void 0}function Ot(e,t,n){return this.constructor(e,n)}function Lt(e,t,n){var o,s,a,l;t==document&&(t=document.documentElement),F.__&&F.__(e,t),s=(o=!1)?null:t.__k,a=[],l=[],Ae(t,e=t.__k=Tt(Q,null,[e]),s||te,te,t.namespaceURI,s?null:t.firstChild?he.call(t.childNodes):null,a,s?s.__e:t.firstChild,o,l),ct(a,e,l)}he=st.slice,F={__e:function(e,t,n,o){for(var s,a,l;t=t.__;)if((s=t.__c)&&!s.__)try{if((a=s.constructor)&&a.getDerivedStateFromError!=null&&(s.setState(a.getDerivedStateFromError(e)),l=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(e,o||{}),l=s.__d),l)return s.__E=s}catch(c){e=c}throw e}},tt=0,ae.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=J({},this.state),typeof e=="function"&&(e=e(J({},n),this.props)),e&&J(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),$e(this))},ae.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),$e(this))},ae.prototype.render=Q,K=[],nt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,rt=function(e,t){return e.__v.__b-t.__v.__b},ie.__r=0,ot=/(PointerCapture)$|Capture$/i,Ee=0,we=Le(!1),ke=Le(!0);var Bt=0;function r(e,t,n,o,s,a){t||(t={});var l,c,u=t;if("ref"in u)for(c in u={},t)c=="ref"?l=t[c]:u[c]=t[c];var d={type:e,props:u,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Bt,__i:-1,__u:0,__source:s,__self:a};if(typeof e=="function"&&(l=e.defaultProps))for(c in l)u[c]===void 0&&(u[c]=l[c]);return F.vnode&&F.vnode(d),d}var ne,N,ye,Be,ce=0,ft=[],O=F,He=O.__b,Re=O.__r,Ue=O.diffed,qe=O.__c,Ge=O.unmount,Je=O.__;function Te(e,t){O.__h&&O.__h(N,e,ce||t),ce=0;var n=N.__H||(N.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function y(e){return ce=1,Ht(pt,e)}function Ht(e,t,n){var o=Te(ne++,2);if(o.t=e,!o.__c&&(o.__=[pt(void 0,t),function(c){var u=o.__N?o.__N[0]:o.__[0],d=o.t(u,c);u!==d&&(o.__N=[d,o.__[1]],o.__c.setState({}))}],o.__c=N,!N.__f)){var s=function(c,u,d){if(!o.__c.__H)return!0;var h=o.__c.__H.__.filter(function(p){return!!p.__c});if(h.every(function(p){return!p.__N}))return!a||a.call(this,c,u,d);var i=o.__c.props!==c;return h.forEach(function(p){if(p.__N){var _=p.__[0];p.__=p.__N,p.__N=void 0,_!==p.__[0]&&(i=!0)}}),a&&a.call(this,c,u,d)||i};N.__f=!0;var a=N.shouldComponentUpdate,l=N.componentWillUpdate;N.componentWillUpdate=function(c,u,d){if(this.__e){var h=a;a=void 0,s(c,u,d),a=h}l&&l.call(this,c,u,d)},N.shouldComponentUpdate=s}return o.__N||o.__}function B(e,t){var n=Te(ne++,3);!O.__s&&ht(n.__H,t)&&(n.__=e,n.u=t,N.__H.__h.push(n))}function _e(e){return ce=5,Rt(function(){return{current:e}},[])}function Rt(e,t){var n=Te(ne++,7);return ht(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function Ut(){for(var e;e=ft.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(le),e.__H.__h.forEach(Ce),e.__H.__h=[]}catch(t){e.__H.__h=[],O.__e(t,e.__v)}}O.__b=function(e){N=null,He&&He(e)},O.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Je&&Je(e,t)},O.__r=function(e){Re&&Re(e),ne=0;var t=(N=e.__c).__H;t&&(ye===N?(t.__h=[],N.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(le),t.__h.forEach(Ce),t.__h=[],ne=0)),ye=N},O.diffed=function(e){Ue&&Ue(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(ft.push(t)!==1&&Be===O.requestAnimationFrame||((Be=O.requestAnimationFrame)||qt)(Ut)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),ye=N=null},O.__c=function(e,t){t.some(function(n){try{n.__h.forEach(le),n.__h=n.__h.filter(function(o){return!o.__||Ce(o)})}catch(o){t.some(function(s){s.__h&&(s.__h=[])}),t=[],O.__e(o,n.__v)}}),qe&&qe(e,t)},O.unmount=function(e){Ge&&Ge(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{le(o)}catch(s){t=s}}),n.__H=void 0,t&&O.__e(t,n.__v))};var je=typeof requestAnimationFrame=="function";function qt(e){var t,n=function(){clearTimeout(o),je&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,35);je&&(t=requestAnimationFrame(n))}function le(e){var t=N,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),N=t}function Ce(e){var t=N;e.__c=e.__(),N=t}function ht(e,t){return!e||e.length!==t.length||t.some(function(n,o){return n!==e[o]})}function pt(e,t){return typeof t=="function"?t(e):t}function q(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${o}`}function Gt(e){const t=new Date(e+"T00:00:00"),n=new Date,o=new Date(n);return o.setDate(o.getDate()-1),e===q(n)?"Today":e===q(o)?"Yesterday":t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}function We(e,t){const n=new Date(e+"T00:00:00");return n.setDate(n.getDate()+t),q(n)}function de(){return q(new Date)}function _t(e=new Date){const t=new Date(e);return t.setDate(t.getDate()-1),q(t)}function Jt(e=new Date){const t=new Date(e),n=t.getDay(),o=t.getDate()-n+(n===0?-6:1);return t.setDate(o),t.setHours(0,0,0,0),t}function jt(e){return e.reduce((t,n)=>({calories:t.calories+(n.calories||0),protein:t.protein+(n.protein||0),carbs:t.carbs+(n.carbs||0),fat:t.fat+(n.fat||0)}),{calories:0,protein:0,carbs:0,fat:0})}function Wt({currentDate:e=de(),onDateChange:t=()=>{},onSettingsClick:n=()=>{},onCalendarClick:o=()=>{},profileName:s=null,onProfileClick:a=()=>{}}){const l=e===de(),c=()=>t(We(e,-1)),u=()=>t(We(e,1));return r("header",{class:"header",children:[r("div",{class:"header-top",children:[r("h1",{class:"header-title",children:"Calorie Tracker"}),r("div",{class:"header-profile",children:[s&&r(Q,{children:[r("span",{class:"header-profile-name",children:s}),r("button",{class:"btn-lock",onClick:a,"aria-label":"Switch profile",children:r("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:[r("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),r("path",{d:"M7 11V7a5 5 0 0110 0v4"})]})})]}),r("button",{class:"btn-icon",onClick:n,"aria-label":"Settings",children:r("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:[r("circle",{cx:"12",cy:"12",r:"3"}),r("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]})})]})]}),r("div",{class:"date-nav",children:[r("button",{class:"btn-icon",onClick:c,"aria-label":"Previous day",children:r("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:r("path",{d:"M15 18l-6-6 6-6"})})}),r("button",{class:"date-display",onClick:o,children:Gt(e)}),r("button",{class:"btn-icon",onClick:u,disabled:l,"aria-label":"Next day",children:r("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:r("path",{d:"M9 18l6-6-6-6"})})})]})]})}const mt=.9,gt=1.1,Yt=30,Vt=[3,7,14,30,50,100,365],zt={calories:2e3,protein:150,carbs:250,fat:65},Kt=.9,Xt=1,Pe=52,Ye=2*Math.PI*Pe;function Qt({entries:e=[],goals:t=zt,profileId:n,date:o,onCelebrationTrigger:s,justLogged:a}){const[l,c]=y(0),u=_e(0),d=e.reduce((m,f)=>({calories:m.calories+(f.calories||0),protein:m.protein+(f.protein||0),carbs:m.carbs+(f.carbs||0),fat:m.fat+(f.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});B(()=>{const m=d.calories,f=u.current;if(a&&m>f){const C=performance.now(),P=E=>{const x=E-C,H=Math.min(x/600,1),A=1-Math.pow(1-H,3),v=Math.round(f+(m-f)*A);c(v),H<1&&requestAnimationFrame(P)};requestAnimationFrame(P)}else c(m);u.current=m},[d.calories,a]);const h=(m,f)=>Math.min(m/f,1),i=(m,f)=>{const g=m/f;return g>Xt?"over":g>=Kt?"close":"under"},p=h(d.calories,t.calories),_=i(d.calories,t.calories),w=Ye*(1-p),k=[{key:"protein",label:"P",value:d.protein,goal:t.protein,color:"var(--color-protein)"},{key:"carbs",label:"C",value:d.carbs,goal:t.carbs,color:"var(--color-carbs)"},{key:"fat",label:"F",value:d.fat,goal:t.fat,color:"var(--color-fat)"}];return B(()=>{if(!n||!o||!s)return;const m=d.calories/t.calories,f=`celebrated-${n}-${o}`,g=localStorage.getItem(f);m>=mt&&m<=gt&&!g&&(localStorage.setItem(f,"true"),s())},[d.calories,t.calories,n,o,s]),r("div",{class:`progress-card progress-card--compact ${a?"progress-card--pulse":""}`,children:r("div",{class:"progress-compact",children:[r("div",{class:"progress-ring progress-ring--compact",children:[r("svg",{viewBox:"0 0 120 120",children:[r("defs",{children:r("linearGradient",{id:"watercolor-sage",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[r("stop",{offset:"0%",stopColor:"var(--color-sage)",stopOpacity:"0.9"}),r("stop",{offset:"50%",stopColor:"var(--color-sage)",stopOpacity:"0.6"}),r("stop",{offset:"100%",stopColor:"var(--color-terracotta)",stopOpacity:"0.8"})]})}),r("circle",{class:"progress-ring-bg",cx:"60",cy:"60",r:Pe}),r("circle",{class:`progress-ring-fill progress-ring-fill--${_}`,cx:"60",cy:"60",r:Pe,strokeDasharray:Ye,strokeDashoffset:w,stroke:"url(#watercolor-sage)"})]}),r("div",{class:"progress-ring-content",children:[r("span",{class:"progress-value progress-value--compact",children:Math.round(l)}),r("span",{class:"progress-label progress-label--compact",children:["of ",t.calories]})]}),r("div",{"aria-live":"polite",class:"sr-only",children:[Math.round(d.calories)," of ",t.calories," calories consumed"]})]}),r("div",{class:"macro-bars",children:k.map(m=>{const f=h(m.value,m.goal),g=Math.round(f*100);return r("div",{class:"macro-bar-row",children:[r("span",{class:"macro-bar-label",children:m.label}),r("div",{class:"macro-bar-track",children:r("div",{class:`macro-bar-fill macro-bar-fill--${m.key}`,style:{width:`${g}%`}})}),r("span",{class:"macro-bar-value",children:[Math.round(m.value),"g"]})]},m.key)})})]})})}const ue=[{id:"breakfast",label:"Breakfast",icon:"ðŸŒ…",hours:[5,10]},{id:"lunch",label:"Lunch",icon:"â˜€ï¸",hours:[11,14]},{id:"dinner",label:"Dinner",icon:"ðŸŒ™",hours:[17,21]},{id:"snack",label:"Snack",icon:"ðŸŽ",hours:null}];function be(){const e=new Date().getHours();for(const t of ue)if(t.hours&&e>=t.hours[0]&&e<=t.hours[1])return t.id;return"snack"}const V="calorie-tracker-goals",ee="calorie-tracker-profiles",yt="calorie-tracker-migrated",Zt="calorie-tracker-pre-migration-backup",ve={calories:2e3,protein:150,carbs:250,fat:65};function G(){try{const e=localStorage.getItem(ee);if(e)return JSON.parse(e).profiles||[]}catch(e){console.error("Failed to load profiles:",e)}return[]}function bt(e){try{const t=JSON.parse(localStorage.getItem(ee)||"{}");t.profiles=e,localStorage.setItem(ee,JSON.stringify(t))}catch(t){console.error("Failed to save profiles:",t)}}function vt(){try{const e=localStorage.getItem(ee);if(e)return JSON.parse(e).activeProfileId||null}catch(e){console.error("Failed to load active profile:",e)}return null}function X(e){try{const t=JSON.parse(localStorage.getItem(ee)||"{}");t.activeProfileId=e,localStorage.setItem(ee,JSON.stringify(t))}catch(t){console.error("Failed to save active profile:",t)}}function en(e,t){const n=G(),o={id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:e,pin:t};return n.push(o),bt(n),o}function tn(e){const t=G().filter(n=>n.id!==e);bt(t),localStorage.removeItem(`${V}-${e}`)}function nn(e,t){const o=G().find(s=>s.id===e);return o&&o.pin===t}function wt(){const e=localStorage.getItem(V)!==null,t=G().length>0,n=localStorage.getItem(yt)==="true";return e&&!t&&!n}function rn(){localStorage.setItem(yt,"true")}function on(e){localStorage.setItem(Zt,e)}function sn(e){const t=localStorage.getItem(V);t&&localStorage.setItem(`${V}-${e}`,t)}function Ve(e=null){try{if(e){const n=localStorage.getItem(`${V}-${e}`);if(n)return{...ve,...JSON.parse(n)}}const t=localStorage.getItem(V);if(t)return{...ve,...JSON.parse(t)}}catch(t){console.error("Failed to load goals:",t)}return ve}function an(e,t=null){try{const n=t?`${V}-${t}`:V;localStorage.setItem(n,JSON.stringify(e))}catch(n){console.error("Failed to save goals:",n)}}function kt(e){try{const t=e?`favorites-${e}`:"favorites",n=localStorage.getItem(t);return n?JSON.parse(n):[]}catch(t){return console.error("Failed to load favorites:",t),[]}}function ln(e,t){try{const n=t?`favorites-${t}`:"favorites";localStorage.setItem(n,JSON.stringify(e.slice(0,20)))}catch(n){console.error("Failed to save favorites:",n)}}function cn(e){try{const t=e?`templates-${e}`:"templates",n=localStorage.getItem(t);return n?JSON.parse(n):[]}catch(t){return console.error("Failed to load templates:",t),[]}}function dn(e,t){try{const n=t?`templates-${t}`:"templates";localStorage.setItem(n,JSON.stringify(e))}catch(n){console.error("Failed to save templates:",n)}}function un({entries:e=[],onEdit:t=()=>{},onDelete:n=()=>{},profileId:o=null,onShowTemplates:s=()=>{}}){const a=c=>{const u=kt(o),d={id:Date.now(),name:c.name,calories:c.calories,protein:c.protein,carbs:c.carbs,fat:c.fat,mealType:c.mealType};ln([d,...u],o)};if(e.length===0)return r("div",{class:"entry-list-empty",children:[r("p",{children:"No entries yet"}),r("p",{class:"entry-list-empty-hint",children:"Tap + to add your first meal"}),r("button",{class:"btn-templates",onClick:s,children:"Use a Template"})]});const l=ue.reduce((c,u)=>(c[u.id]=e.filter(d=>(d.mealType||"snack")===u.id),c),{});return r("div",{class:"entry-list",children:ue.map(c=>{const u=l[c.id];if(u.length===0)return null;const d=u.reduce((h,i)=>h+i.calories,0);return r("div",{class:"meal-group",children:[r("h3",{class:"meal-group-header",children:[c.icon," ",c.label," ",r("span",{class:"meal-subtotal",children:[d," cal"]})]}),u.map(h=>r("div",{class:"entry-card",children:[r("div",{class:"entry-main",onClick:()=>t(h),children:[r("span",{class:"entry-name",children:h.name}),r("span",{class:"entry-calories",children:[h.calories," cal"]})]}),r("div",{class:"entry-macros",children:[r("span",{class:"entry-macro entry-macro--protein",children:[h.protein,"g"]}),r("span",{class:"entry-macro entry-macro--carbs",children:[h.carbs,"g"]}),r("span",{class:"entry-macro entry-macro--fat",children:[h.fat,"g"]})]}),r("div",{class:"entry-actions",children:[r("button",{class:"btn-star",onClick:i=>{i.stopPropagation(),a(h)},"aria-label":`Add ${h.name} to favorites`,children:"â­"}),r("button",{class:"entry-delete",onClick:()=>n(h),"aria-label":`Delete ${h.name}`,children:r("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:r("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2"})})})]})]},h.id))]},c.id)})})}const fn="calorie-tracker",hn=3,$="entries";let oe=null;function j(){return oe||(oe=new Promise((e,t)=>{const n=indexedDB.open(fn,hn);n.onerror=()=>t(n.error),n.onsuccess=()=>e(n.result),n.onupgradeneeded=o=>{const s=o.target.result;let a;s.objectStoreNames.contains($)?a=o.target.transaction.objectStore($):(a=s.createObjectStore($,{keyPath:"id"}),a.createIndex("date","date",{unique:!1})),o.oldVersion<2&&(a.indexNames.contains("profileDate")||a.createIndex("profileDate",["profileId","date"],{unique:!1})),o.oldVersion<3&&(a.openCursor().onsuccess=l=>{const c=l.target.result;c&&(c.value.mealType||(c.value.mealType="snack",c.update(c.value)),c.continue())})}}),oe)}async function ze(e){const n=(await j()).transaction($,"readwrite"),o=n.objectStore($),s=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,a={...e,id:s};return o.add(a),new Promise((l,c)=>{n.oncomplete=()=>l(a),n.onerror=()=>c(n.error)})}async function pn(e){const n=(await j()).transaction($,"readwrite");return n.objectStore($).put(e),new Promise((s,a)=>{n.oncomplete=()=>s(e),n.onerror=()=>a(n.error)})}async function _n(e){const n=(await j()).transaction($,"readwrite");return n.objectStore($).delete(e),new Promise((s,a)=>{n.oncomplete=()=>s(),n.onerror=()=>a(n.error)})}async function mn(){const o=(await j()).transaction($,"readonly").objectStore($).getAll();return new Promise((s,a)=>{o.onsuccess=()=>s(o.result),o.onerror=()=>a(o.error)})}async function St(){const e=await mn();return JSON.stringify({entries:e,exportedAt:new Date().toISOString()},null,2)}async function gn(e){const t=JSON.parse(e),o=(await j()).transaction($,"readwrite"),s=o.objectStore($);for(const a of t.entries)s.put(a);return new Promise((a,l)=>{o.oncomplete=()=>a(t.entries.length),o.onerror=()=>l(o.error)})}async function yn(e,t=null){const s=(await j()).transaction($,"readonly").objectStore($);if(!t){const u=s.index("date").getAll(e);return new Promise((d,h)=>{u.onsuccess=()=>{const i=u.result.filter(p=>!p.profileId);d(i)},u.onerror=()=>h(u.error)})}const l=s.index("profileDate").getAll([t,e]);return new Promise((c,u)=>{l.onsuccess=()=>c(l.result),l.onerror=()=>u(l.error)})}async function bn(e){const n=(await j()).transaction($,"readwrite"),o=n.objectStore($),s=o.getAll();return new Promise((a,l)=>{s.onsuccess=()=>{const c=s.result;for(const u of c)u.profileId||(u.profileId=e,o.put(u));n.oncomplete=()=>a(c.length),n.onerror=()=>l(n.error)},s.onerror=()=>l(s.error)})}async function vn(e){const n=(await j()).transaction($,"readwrite"),o=n.objectStore($),s=o.getAll();return new Promise((a,l)=>{s.onsuccess=()=>{const c=s.result;let u=0;for(const d of c)d.profileId===e&&(o.delete(d.id),u++);n.oncomplete=()=>a(u),n.onerror=()=>l(n.error)},s.onerror=()=>l(s.error)})}async function wn(e,t=10){const n=new Date;n.setDate(n.getDate()-7);const l=(await j()).transaction($,"readonly").objectStore($).getAll();return new Promise((c,u)=>{l.onsuccess=()=>{const d=l.result.filter(p=>e&&p.profileId!==e||!e&&p.profileId?!1:new Date(p.date+"T00:00:00")>=n),h=new Map;for(const p of d){const _=h.get(p.name)||0;h.set(p.name,_+1)}const i=Array.from(h.entries()).sort((p,_)=>_[1]-p[1]).slice(0,t).map(([p])=>{const _=d.find(w=>w.name===p);return{name:p,calories:_.calories,protein:_.protein,carbs:_.carbs,fat:_.fat,mealType:_.mealType}});c(i)},l.onerror=()=>u(l.error)})}function kn({profileId:e,onSelect:t,onClose:n}){const o=kt(e);return r("div",{class:"favorites-picker-overlay",onClick:n,children:r("div",{class:"favorites-picker",onClick:s=>s.stopPropagation(),children:[r("div",{class:"favorites-header",children:[r("h3",{children:"Favorites"}),r("button",{class:"close-btn",onClick:n,"aria-label":"Close",children:"Ã—"})]}),o.length===0?r("p",{class:"favorites-empty",children:"No favorites yet. Star an entry to add it."}):r("ul",{class:"favorites-list",children:o.map(s=>r("li",{children:r("button",{class:"favorite-item",onClick:()=>t(s),children:[r("strong",{children:s.name}),r("span",{children:[s.calories," cal"]})]})},s.id))})]})})}function Sn({entry:e=null,onSave:t=()=>{},onCancel:n=()=>{},profileId:o=null}){const[s,a]=y(""),[l,c]=y(""),[u,d]=y(""),[h,i]=y(""),[p,_]=y(""),[w,k]=y(be()),[m,f]=y([]),[g,C]=y(!1),[P,E]=y({}),[x,H]=y({}),A=!!e,v=()=>{const b={};return s.trim()||(b.name="Food name is required"),l===""||l===null?b.calories="Calories is required":parseInt(l)<0&&(b.calories="Calories must be positive"),b},D=b=>{H(L=>({...L,[b]:!0})),E(v())};B(()=>{var b,L,R,S;e?(a(e.name||""),c(((b=e.calories)==null?void 0:b.toString())||""),d(((L=e.protein)==null?void 0:L.toString())||""),i(((R=e.carbs)==null?void 0:R.toString())||""),_(((S=e.fat)==null?void 0:S.toString())||""),k(e.mealType||be())):(a(""),c(""),d(""),i(""),_(""),k(be()))},[e]),B(()=>{wn(o).then(f)},[o]);const M=b=>{var L,R,S,T;a(b.name),c(((L=b.calories)==null?void 0:L.toString())||""),d(((R=b.protein)==null?void 0:R.toString())||""),i(((S=b.carbs)==null?void 0:S.toString())||""),_(((T=b.fat)==null?void 0:T.toString())||""),b.mealType&&k(b.mealType)};return r(Q,{children:[g&&r(kn,{profileId:o,onSelect:b=>{M(b),C(!1)},onClose:()=>C(!1)}),r("div",{class:"form-overlay",onClick:n,children:r("form",{class:"entry-form",onClick:b=>b.stopPropagation(),onSubmit:b=>{b.preventDefault();const L=v();E(L),H({name:!0,calories:!0}),!(Object.keys(L).length>0)&&t({...e||{},name:s.trim(),calories:parseInt(l)||0,protein:parseInt(u)||0,carbs:parseInt(h)||0,fat:parseInt(p)||0,mealType:w})},children:[r("h2",{class:"form-title",children:A?"Edit Entry":"Add Entry"}),r("div",{class:"meal-selector",children:ue.map(b=>r("button",{type:"button",class:`meal-btn ${w===b.id?"active":""}`,onClick:()=>k(b.id),children:[r("span",{children:b.icon}),r("span",{children:b.label})]},b.id))}),!A&&r(Q,{children:[m.length>0&&r("div",{class:"recent-foods",children:[r("label",{class:"recent-label",children:"Recently logged:"}),r("div",{class:"recent-chips",children:m.map((b,L)=>r("button",{type:"button",class:"recent-chip",onClick:()=>M(b),children:b.name},L))})]}),r("div",{class:"favorites-section",children:r("button",{type:"button",class:"btn-favorites",onClick:()=>C(!0),children:"â­ Favorites"})})]}),r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"name",children:"Food Name"}),r("input",{id:"name",type:"text",class:`form-input ${x.name&&P.name?"form-input--error":""}`,value:s,onInput:b=>a(b.target.value),onBlur:()=>D("name"),placeholder:"e.g., Chicken Salad","aria-invalid":x.name&&P.name?"true":"false","aria-describedby":x.name&&P.name?"name-error":void 0,autoFocus:!0}),x.name&&P.name&&r("span",{id:"name-error",class:"form-error",role:"alert",children:P.name})]}),r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"calories",children:"Calories"}),r("input",{id:"calories",type:"number",class:`form-input ${x.calories&&P.calories?"form-input--error":""}`,value:l,onInput:b=>c(b.target.value),onBlur:()=>D("calories"),placeholder:"0",min:"0",step:"1","aria-invalid":x.calories&&P.calories?"true":"false","aria-describedby":x.calories&&P.calories?"calories-error":void 0}),x.calories&&P.calories&&r("span",{id:"calories-error",class:"form-error",role:"alert",children:P.calories})]}),r("div",{class:"form-row",children:[r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"protein",children:"Protein (g)"}),r("input",{id:"protein",type:"number",class:"form-input",value:u,onInput:b=>d(b.target.value),placeholder:"0",min:"0",step:"1"})]}),r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"carbs",children:"Carbs (g)"}),r("input",{id:"carbs",type:"number",class:"form-input",value:h,onInput:b=>i(b.target.value),placeholder:"0",min:"0",step:"1"})]}),r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"fat",children:"Fat (g)"}),r("input",{id:"fat",type:"number",class:"form-input",value:p,onInput:b=>_(b.target.value),placeholder:"0",min:"0",step:"1"})]})]}),r("div",{class:"form-actions",children:[r("button",{type:"button",class:"btn btn--secondary",onClick:n,children:"Cancel"}),r("button",{type:"submit",class:"btn btn--primary",children:A?"Save Changes":"Add Entry"})]})]})})]})}function Fe({onProfileSelect:e,onClose:t,isPickerMode:n=!1}){const[o,s]=y(G()),[a,l]=y(!1),[c,u]=y(null),[d,h]=y(""),[i,p]=y(""),[_,w]=y(""),[k,m]=y(""),[f,g]=y(null),C=vt(),P=v=>{nn(v,d)?(X(v),h(""),m(""),e(v)):(m("Wrong PIN"),h(""))},E=async()=>{if(!i.trim()){m("Name required");return}if(_.length!==4||!/^\d+$/.test(_)){m("PIN must be 4 digits");return}const v=G().length===0,D=en(i.trim(),_);if(v&&wt())try{const M=await St();on(M),await bn(D.id),sn(D.id),rn()}catch(M){console.error("Migration failed:",M),m("Migration failed. Your data is backed up.")}s(G()),p(""),w(""),l(!1),m(""),v&&(X(D.id),e(D.id))},x=async v=>{if(await vn(v),tn(v),s(G()),g(null),v===C){const D=G();D.length>0?(X(D[0].id),e(D[0].id)):X(null)}},H=()=>{X(null),e(null)};if(n||!C)return r("div",{class:"modal-overlay",onClick:t,children:r("div",{class:"profile-modal",onClick:v=>v.stopPropagation(),children:[r("h2",{class:"form-title",children:"Who's tracking?"}),o.length===0?r("p",{class:"profile-empty",children:"No profiles yet. Add one to get started!"}):r("div",{class:"profile-list",children:o.map(v=>r("div",{class:"profile-item",children:c===v.id?r("div",{class:"profile-pin-entry",children:[r("span",{class:"profile-name",children:v.name}),r("input",{type:"password",inputMode:"numeric",maxLength:4,placeholder:"PIN",value:d,onInput:D=>h(D.target.value),onKeyDown:D=>D.key==="Enter"&&P(v.id),autoFocus:!0,class:"pin-input"}),r("button",{class:"btn btn--primary btn--sm",onClick:()=>P(v.id),children:"Go"}),r("button",{class:"btn btn--secondary btn--sm",onClick:()=>{u(null),h(""),m("")},children:"Cancel"})]}):r("button",{class:"profile-select-btn",onClick:()=>u(v.id),children:v.name})},v.id))}),k&&r("p",{class:"error-message",children:k}),a?r("div",{class:"profile-add-form",children:[r("input",{type:"text",placeholder:"Name",value:i,onInput:v=>p(v.target.value),class:"form-input",autoFocus:!0}),r("input",{type:"password",inputMode:"numeric",maxLength:4,placeholder:"4-digit PIN",value:_,onInput:v=>w(v.target.value),class:"form-input"}),r("div",{class:"form-actions",children:[r("button",{class:"btn btn--secondary",onClick:()=>l(!1),children:"Cancel"}),r("button",{class:"btn btn--primary",onClick:E,children:"Create Profile"})]})]}):r("button",{class:"btn btn--secondary profile-add-btn",onClick:()=>l(!0),children:"+ Add Profile"})]})});const A=o.find(v=>v.id===C);return r("div",{class:"profile-management",children:[r("h3",{class:"form-section-title",children:"Current Profile"}),r("p",{class:"current-profile-name",children:(A==null?void 0:A.name)||"Unknown"}),r("div",{class:"profile-actions",children:[r("button",{class:"btn btn--secondary",onClick:H,children:"Switch Profile"}),r("button",{class:"btn btn--secondary",onClick:()=>l(!0),children:"Add Profile"}),o.length>1&&r("button",{class:"btn btn--danger",onClick:()=>g(C),children:"Delete Profile"})]}),a&&r("div",{class:"profile-add-form",children:[r("input",{type:"text",placeholder:"Name",value:i,onInput:v=>p(v.target.value),class:"form-input"}),r("input",{type:"password",inputMode:"numeric",maxLength:4,placeholder:"4-digit PIN",value:_,onInput:v=>w(v.target.value),class:"form-input"}),r("div",{class:"form-actions",children:[r("button",{class:"btn btn--secondary",onClick:()=>l(!1),children:"Cancel"}),r("button",{class:"btn btn--primary",onClick:E,children:"Create"})]})]}),k&&r("p",{class:"error-message",children:k}),f&&r("div",{class:"delete-confirm",children:[r("p",{children:["Delete ",A==null?void 0:A.name,"'s profile? This removes all their data."]}),r("div",{class:"form-actions",children:[r("button",{class:"btn btn--secondary",onClick:()=>g(null),children:"Cancel"}),r("button",{class:"btn btn--danger",onClick:()=>x(f),children:"Delete"})]})]})]})}const Ke={morning:{cream:"#FFF8F0",white:"#FFFCF8",sage:"#7BA393",sageLight:"#9DBCAD",sagePale:"#E0EDE6",sageFaint:"#F0F6F3",terracotta:"#E8A080",terracottaLight:"#F0BDA8",terracottaPale:"#FCF0E8",espresso:"#4A4038",warmGray:"#7A7068",muted:"#A09890",success:"#7BA393",warning:"#F0C090",protein:"#E8A080",carbs:"#E8C878",fat:"#7BA393"},midday:{cream:"#FFFDF5",white:"#FFFEF8",sage:"#E63946",sageLight:"#F25C69",sagePale:"#FCECED",sageFaint:"#FEF5F5",terracotta:"#1D3557",terracottaLight:"#457B9D",terracottaPale:"#E8EEF4",espresso:"#1A1A1A",warmGray:"#4A4A4A",muted:"#7A7A7A",success:"#2A9D8F",warning:"#FFB703",protein:"#1D3557",carbs:"#FFB703",fat:"#E63946"},evening:{cream:"#E8E0F0",white:"#F0EBF5",sage:"#7B6B9E",sageLight:"#9A8BB8",sagePale:"#E0D8EB",sageFaint:"#F0ECF5",terracotta:"#E8A87C",terracottaLight:"#F0C4A0",terracottaPale:"#F8EEE5",espresso:"#3D3655",warmGray:"#605878",muted:"#8A82A0",success:"#88A0B8",warning:"#E8B888",protein:"#C87888",carbs:"#E8B078",fat:"#88A0C0"},night:{cream:"#0D0D0D",white:"#1A1A1A",sage:"#9FFFB0",sageLight:"#B8FFC8",sagePale:"#1A2A1E",sageFaint:"#0F1A12",terracotta:"#FF1744",terracottaLight:"#FF5252",terracottaPale:"#2A1A18",espresso:"#FFFFFF",warmGray:"#E0E0E0",muted:"#A0A0A0",success:"#9FFFB0",warning:"#FFB080",protein:"#FF3366",carbs:"#FFFF00",fat:"#00FF88"}};function Xe(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function Cn(e,t,n){return"#"+[e,t,n].map(o=>{const s=Math.round(Math.max(0,Math.min(255,o))).toString(16);return s.length===1?"0"+s:s}).join("")}function Pn(e,t,n){const o=Xe(e),s=Xe(t);if(!o||!s)return e;const a=o.r+(s.r-o.r)*n,l=o.g+(s.g-o.g)*n,c=o.b+(s.b-o.b)*n;return Cn(a,l,c)}function Fn(){const e=new Date,t=e.getHours(),n=e.getMinutes(),o=t+n/60,s=[{start:5,end:11,theme:"morning",peak:8},{start:11,end:16,theme:"midday",peak:13.5},{start:16,end:20,theme:"evening",peak:18},{start:20,end:29,theme:"night",peak:24},{start:0,end:5,theme:"night",peak:2.5}];let a=s.find(p=>o>=p.start&&o<p.end);a||(a=s[3]);const l=["morning","midday","evening","night"],c=l.indexOf(a.theme),u=l[(c+1)%4],d=a.end-a.start,h=(o-a.start)/d;let i=0;return h>.6&&(i=(h-.6)/.4),{primary:a.theme,secondary:u,factor:i}}function Dn(){const{primary:e,secondary:t,factor:n}=Fn(),o=Ke[e],s=Ke[t],a={};for(const l of Object.keys(o))a[l]=Pn(o[l],s[l],n);return{palette:a,primary:e,secondary:t,factor:n}}function En(){const{palette:e,primary:t}=Dn(),n=document.documentElement;document.body.className=`theme-${t}`,n.style.setProperty("--color-cream",e.cream),n.style.setProperty("--color-white",e.white),n.style.setProperty("--color-sage",e.sage),n.style.setProperty("--color-sage-light",e.sageLight),n.style.setProperty("--color-sage-pale",e.sagePale),n.style.setProperty("--color-sage-faint",e.sageFaint),n.style.setProperty("--color-terracotta",e.terracotta),n.style.setProperty("--color-terracotta-light",e.terracottaLight),n.style.setProperty("--color-terracotta-pale",e.terracottaPale),n.style.setProperty("--color-espresso",e.espresso),n.style.setProperty("--color-warm-gray",e.warmGray),n.style.setProperty("--color-muted",e.muted),n.style.setProperty("--color-success",e.success),n.style.setProperty("--color-warning",e.warning),n.style.setProperty("--color-protein",e.protein),n.style.setProperty("--color-carbs",e.carbs),n.style.setProperty("--color-fat",e.fat)}function Qe(){const e=document.documentElement;["--color-cream","--color-white","--color-sage","--color-sage-light","--color-sage-pale","--color-sage-faint","--color-terracotta","--color-terracotta-light","--color-terracotta-pale","--color-espresso","--color-warm-gray","--color-muted","--color-success","--color-warning","--color-protein","--color-carbs","--color-fat"].forEach(n=>e.style.removeProperty(n))}function Ct(){return localStorage.getItem("theme-preference")||"auto"}function xn(e){localStorage.setItem("theme-preference",e),De()}function De(){const e=Ct();if(e==="dark"){Qe(),document.body.className="theme-night";return}if(e==="light"){Qe(),document.body.className="theme-midday";return}En()}function An(){const[e,t]=y(Ct()),n=o=>{t(o),xn(o)};return r("div",{style:"margin-bottom: var(--space-4)",children:[r("label",{class:"form-label",children:"Theme"}),r("select",{class:"form-input",value:e,onChange:o=>n(o.target.value),children:[r("option",{value:"auto",children:"Auto (time-based)"}),r("option",{value:"light",children:"Light"}),r("option",{value:"dark",children:"Dark"})]})]})}async function Mn(){return"Notification"in window?Notification.permission==="granted"?"granted":Notification.permission==="denied"?"denied":await Notification.requestPermission():"unsupported"}function Tn(e){const t=e?`notifications-${e}`:"notifications",n=localStorage.getItem(t);return n?JSON.parse(n):{enabled:!1,times:["08:00","12:00","18:00"]}}function Ze(e,t){const n=e?`notifications-${e}`:"notifications";localStorage.setItem(n,JSON.stringify(t))}function In({goals:e={},onSave:t=()=>{},onClose:n=()=>{},onDataChange:o=()=>{},onProfileChange:s=()=>{},activeProfileId:a=null}){var W,b,L,R;const[l,c]=y(((W=e.calories)==null?void 0:W.toString())||"2000"),[u,d]=y(((b=e.protein)==null?void 0:b.toString())||"150"),[h,i]=y(((L=e.carbs)==null?void 0:L.toString())||"250"),[p,_]=y(((R=e.fat)==null?void 0:R.toString())||"65"),[w,k]=y(""),m=_e(null),g=G().length>0,[C,P]=y(()=>Tn(a)),[E,x]=y(()=>typeof Notification<"u"?Notification.permission:"unsupported");B(()=>{const S=T=>{T.key==="Escape"&&n()};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[n]);const H=S=>{S.preventDefault(),t({calories:parseInt(l)||2e3,protein:parseInt(u)||150,carbs:parseInt(h)||250,fat:parseInt(p)||65})},A=async()=>{try{const S=await St(),T=new Blob([S],{type:"application/json"}),z=URL.createObjectURL(T),Y=document.createElement("a");Y.href=z,Y.download=`calorie-tracker-backup-${new Date().toISOString().split("T")[0]}.json`,Y.click(),URL.revokeObjectURL(z),k("Data exported!"),setTimeout(()=>k(""),2e3)}catch{k("Export failed")}},v=async S=>{var z;const T=(z=S.target.files)==null?void 0:z[0];if(T){try{const Y=await T.text(),me=await gn(Y);k(`Imported ${me} entries!`),o==null||o(),setTimeout(()=>k(""),2e3)}catch{k("Import failed")}S.target.value=""}},D=S=>{s(S)},M=async()=>{const S=await Mn();if(x(S),S==="granted"){const T={...C,enabled:!0};P(T),Ze(a,T)}},U=S=>{const T={...C,enabled:S};P(T),Ze(a,T)};return r("div",{class:"form-overlay",onClick:n,children:r("form",{class:"entry-form",onClick:S=>S.stopPropagation(),onSubmit:H,children:[r("h2",{class:"form-title",children:"Settings"}),g&&r(Fe,{onProfileSelect:D,onClose:()=>{},isPickerMode:!1}),!g&&r("div",{class:"profile-management",children:[r("h3",{class:"form-section-title",children:"Profiles"}),r("p",{class:"profile-hint",children:"Add profiles for multiple users on this device."}),r(Fe,{onProfileSelect:D,onClose:()=>{},isPickerMode:!0})]}),r(An,{}),r("h3",{class:"form-section-title",children:"Daily Goals"}),r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"goal-calories",children:"Calories"}),r("input",{id:"goal-calories",type:"number",class:"form-input",value:l,onInput:S=>c(S.target.value),min:"0",step:"1"})]}),r("div",{class:"form-row",children:[r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"goal-protein",children:"Protein (g)"}),r("input",{id:"goal-protein",type:"number",class:"form-input",value:u,onInput:S=>d(S.target.value),min:"0",step:"1"})]}),r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"goal-carbs",children:"Carbs (g)"}),r("input",{id:"goal-carbs",type:"number",class:"form-input",value:h,onInput:S=>i(S.target.value),min:"0",step:"1"})]}),r("div",{class:"form-field",children:[r("label",{class:"form-label",for:"goal-fat",children:"Fat (g)"}),r("input",{id:"goal-fat",type:"number",class:"form-input",value:p,onInput:S=>_(S.target.value),min:"0",step:"1"})]})]}),r("h3",{class:"form-section-title",children:"Notifications"}),E==="unsupported"?r("p",{class:"profile-hint",children:"Notifications not supported in this browser."}):E==="denied"?r("p",{class:"profile-hint",children:"Notifications blocked. Enable in browser settings."}):C.enabled?r("div",{children:r("div",{class:"form-field",children:r("label",{class:"form-label",children:[r("input",{type:"checkbox",checked:C.enabled,onChange:S=>U(S.target.checked)}),"Enable reminder notifications"]})})}):r("button",{type:"button",class:"btn btn--secondary",onClick:M,children:"Enable Notifications"}),r("h3",{class:"form-section-title",children:"Data"}),r("div",{class:"data-actions",children:[r("button",{type:"button",class:"btn btn--secondary",onClick:A,children:"Export Data"}),r("button",{type:"button",class:"btn btn--secondary",onClick:()=>{var S;return(S=m.current)==null?void 0:S.click()},children:"Import Data"}),r("input",{ref:m,type:"file",accept:".json",style:{display:"none"},onChange:v})]}),w&&r("p",{class:"status-message",children:w}),r("div",{class:"form-actions",children:[r("button",{type:"button",class:"btn btn--secondary",onClick:n,children:"Cancel"}),r("button",{type:"submit",class:"btn btn--primary",children:"Save Goals"})]})]})})}function et({title:e="Confirm",message:t="",onConfirm:n=()=>{},onCancel:o=()=>{},confirmText:s="Delete",danger:a=!1}){return B(()=>{const l=c=>{c.key==="Escape"&&o()};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[o]),r("div",{class:"modal-overlay",onClick:o,children:r("div",{class:"modal",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",onClick:l=>l.stopPropagation(),children:[r("h3",{id:"modal-title",class:"modal-title",children:e}),r("p",{class:"modal-message",children:t}),r("div",{class:"modal-actions",children:[r("button",{class:"btn btn--secondary",onClick:o,children:"Cancel"}),r("button",{class:`btn ${a?"btn--danger":"btn--primary"}`,onClick:n,children:s})]})]})})}function Nn({onClick:e}){return r("button",{class:"quick-add-btn",onClick:e,"aria-label":"Log a meal",children:[r("span",{class:"quick-add-icon",children:"ðŸ½ï¸"}),r("span",{class:"quick-add-text",children:"Log Meal"})]})}function $n({entries:e,totalCalories:t,expanded:n,onToggle:o,justLogged:s}){const[a,l]=y(!1),c=_e(t);if(B(()=>{if(s&&t>c.current){l(!0);const h=setTimeout(()=>l(!1),2e3);return()=>clearTimeout(h)}c.current=t},[t,s]),e.length===0)return null;const u=e.length,d=u===1?"meal":"meals";return r("button",{class:`today-summary ${a?"today-summary--confirmed":""}`,onClick:o,"aria-expanded":n,"aria-label":`Today: ${u} ${d}, ${Math.round(t)} calories. Click to ${n?"collapse":"expand"}`,children:[r("span",{class:"today-summary-text",children:["Today: ",u," ",d,", ",Math.round(t)," cal"]}),a?r("span",{class:"today-summary-check","aria-hidden":"true",children:"âœ“"}):r("span",{class:`today-summary-arrow ${n?"today-summary-arrow--up":""}`,"aria-hidden":"true",children:"â–¼"})]})}const On=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Ln=["January","February","March","April","May","June","July","August","September","October","November","December"];function Bn({currentDate:e,onSelect:t,onClose:n}){const[o,s]=y(()=>{const f=new Date(e+"T00:00:00");return{year:f.getFullYear(),month:f.getMonth()}});B(()=>{const f=g=>{g.key==="Escape"&&n()};return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[n]);const a=de(),l=new Date(a+"T00:00:00"),c=(f,g)=>new Date(f,g+1,0).getDate(),u=(f,g)=>new Date(f,g,1).getDay(),d=c(o.year,o.month),h=u(o.year,o.month),i=()=>{s(f=>f.month===0?{year:f.year-1,month:11}:{...f,month:f.month-1})},p=()=>{const f=new Date;new Date(o.year,o.month+1,1)>f||s(C=>C.month===11?{year:C.year+1,month:0}:{...C,month:C.month+1})},_=f=>{const g=new Date(o.year,o.month,f);g>l||(t(q(g)),n())},w=()=>{t(a),n()},k=o.year===l.getFullYear()&&o.month===l.getMonth(),m=[];for(let f=0;f<h;f++)m.push(r("div",{class:"calendar-day calendar-day--empty"},`empty-${f}`));for(let f=1;f<=d;f++){const g=q(new Date(o.year,o.month,f)),C=g===a,P=g===e,E=new Date(o.year,o.month,f)>l;m.push(r("button",{class:`calendar-day ${C?"calendar-day--today":""} ${P?"calendar-day--selected":""} ${E?"calendar-day--disabled":""}`,onClick:()=>_(f),disabled:E,children:f},f))}return r("div",{class:"modal-overlay",onClick:n,children:r("div",{class:"calendar-modal",onClick:f=>f.stopPropagation(),children:[r("div",{class:"calendar-header",children:[r("button",{class:"btn-icon",onClick:i,"aria-label":"Previous month",children:r("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:r("path",{d:"M15 18l-6-6 6-6"})})}),r("span",{class:"calendar-title",children:[Ln[o.month]," ",o.year]}),r("button",{class:"btn-icon",onClick:p,disabled:k,"aria-label":"Next month",children:r("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",children:r("path",{d:"M9 18l6-6-6-6"})})})]}),r("div",{class:"calendar-weekdays",children:On.map(f=>r("div",{class:"calendar-weekday",children:f},f))}),r("div",{class:"calendar-days",children:m}),r("button",{class:"btn btn--secondary calendar-today-btn",onClick:w,children:"Go to Today"})]})})}function Hn({onComplete:e}){const t=_e(null);return B(()=>{const n=t.current;if(!n)return;const o=n.getContext("2d");n.width=window.innerWidth,n.height=window.innerHeight;const s=["#8B9D82","#C87864","#E8DFD8","#FDF6F0"],a=[];for(let d=0;d<50;d++)a.push({x:Math.random()*n.width,y:Math.random()*n.height,radius:0,maxRadius:Math.random()*40+20,color:s[Math.floor(Math.random()*s.length)],delay:Math.random()*500,opacity:1});let l=null;const c=2e3;function u(d){l||(l=d);const h=d-l;o.clearRect(0,0,n.width,n.height);let i=!0;a.forEach(p=>{const _=h-p.delay;if(_<0){i=!1;return}const w=Math.min(_/c,1);p.radius=p.maxRadius*Math.sin(w*Math.PI),p.opacity=1-w,w<1&&(i=!1),o.beginPath(),o.fillStyle=p.color,o.globalAlpha=p.opacity*.7,o.arc(p.x,p.y,p.radius,0,Math.PI*2),o.fill()}),o.globalAlpha=1,i?e==null||e():requestAnimationFrame(u)}requestAnimationFrame(u)},[e]),r("div",{role:"status","aria-live":"assertive",children:[r("canvas",{ref:t,style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:1e3},"aria-hidden":"true"}),r("div",{class:"sr-only",children:"Congratulations! You hit your calorie goal!"})]})}function fe(e){const t=e?`streak-${e}`:"streak",n=localStorage.getItem(t);return n?JSON.parse(n):{current:0,longest:0,lastSuccessDate:null,history:[],weeklyGoal:5,weeklyProgress:0,milestones:[]}}function Pt(e,t){const n=e?`streak-${e}`:"streak";localStorage.setItem(n,JSON.stringify(t))}function Rn(e,t){if(!t||t===0)return!1;const n=e/t;return n>=mt&&n<=gt}function Un(e,t,n,o){const s=fe(e),a=Rn(n,o),l=q(new Date),c=_t(new Date),u=s.history.findIndex(i=>i.date===t),d={date:t,success:a,calories:n,goal:o,ratio:o>0?n/o:0};u>=0?s.history[u]=d:s.history.push(d),s.history=s.history.sort((i,p)=>new Date(p.date)-new Date(i.date)).slice(0,Yt),t===l&&a?(s.lastSuccessDate===c?s.current++:s.lastSuccessDate!==l&&(s.current=1),s.lastSuccessDate=l,s.longest=Math.max(s.longest,s.current)):t===l&&!a&&s.lastSuccessDate!==l&&s.lastSuccessDate!==c&&s.lastSuccessDate!==l&&(s.current=0),s.weeklyProgress=qn(s.history);const h=Jn(s);if(h.length>0){s.milestones=s.milestones||[];for(const i of h)s.milestones.includes(i.days)||s.milestones.push(i.days);s.milestones.sort((i,p)=>i-p)}return Pt(e,s),s}function qn(e){const t=Jt(new Date),n=q(t);return e.filter(o=>o.success&&o.date>=n).length}function Gn(e,t,n){const o=q(new Date),s=t.filter(c=>c.date===o);if(s.length>0){const c=jt(s);Un(e,o,c.calories,n.calories)}const a=fe(e),l=_t(new Date);return a.lastSuccessDate&&a.lastSuccessDate!==o&&a.lastSuccessDate!==l&&(a.current=0,Pt(e,a)),fe(e)}function Jn(e){const t=e.milestones||[];return Vt.filter(n=>e.current>=n&&!t.includes(n)).map(n=>({days:n,message:jn(n),achieved:!0}))}function jn(e){return{3:"Three days strong!",7:"One week warrior!",14:"Two week champion!",30:"Monthly master!",50:"Fifty day legend!",100:"Century club!",365:"Full year hero!"}[e]||`${e} days!`}function Wn({profileId:e,profile:t,onDateClick:n}){var h;const[o,s]=y(!1),a=fe(e),l=[],c=new Date,u=q(c);for(let i=13;i>=0;i--){const p=new Date(c);p.setDate(p.getDate()-i);const _=q(p),w=(h=a.history)==null?void 0:h.find(m=>m.date===_);let k="missed";w!=null&&w.success?k="success":_===u&&(k="pending"),l.push({date:_,status:k,isToday:_===u})}const d=a.current||0;return r("div",{class:"streak-display streak-display--collapsible",children:[r("button",{class:"streak-collapsed",onClick:()=>s(!o),"aria-expanded":o,"aria-label":`${d} day streak. Click to ${o?"collapse":"view details"}`,children:[r("span",{class:"streak-collapsed-content",children:[r("span",{class:"streak-fire",children:"ðŸ”¥"}),r("span",{class:"streak-count",children:[d," day streak"]})]}),r("span",{class:`streak-expand-arrow ${o?"streak-expand-arrow--up":""}`,children:o?"â–²":"â–¼"})]}),o&&r("div",{class:"streak-expanded",children:[r("div",{class:"streak-stats",children:[r("div",{class:"streak-stat",children:[r("span",{class:"streak-stat-number",children:d}),r("span",{class:"streak-stat-label",children:"current"})]}),r("div",{class:"streak-stat",children:[r("span",{class:"streak-stat-number",children:a.longest||0}),r("span",{class:"streak-stat-label",children:"longest"})]}),a.weeklyGoal&&r("div",{class:"streak-stat",children:[r("span",{class:"streak-stat-number",children:[a.weeklyProgress||0,"/",a.weeklyGoal]}),r("span",{class:"streak-stat-label",children:"this week"})]})]}),r("div",{class:"streak-calendar",children:[r("div",{class:"calendar-day-labels",children:["S","M","T","W","T","F","S"].map((i,p)=>r("span",{class:"day-label",children:i},p))}),r("div",{class:"calendar-dots",children:l.map(i=>r("button",{class:`streak-dot streak-${i.status} ${i.isToday?"streak-today":""}`,onClick:()=>n==null?void 0:n(i.date),"aria-label":`${i.date}: ${i.status}`},i.date))})]}),(a.milestones||[]).length>0&&r("div",{class:"milestone-badges",children:(a.milestones||[]).map(i=>r("span",{class:"milestone-badge",children:["ðŸ† ",i]},i))})]})]})}function Yn({profileId:e,onSelect:t,onClose:n}){const[o,s]=y(cn(e)),a=l=>{const c=o.filter(u=>u.id!==l);dn(c,e),s(c)};return r("div",{class:"template-manager-overlay",onClick:n,children:r("div",{class:"template-manager",onClick:l=>l.stopPropagation(),children:[r("div",{class:"template-header",children:[r("h3",{children:"Meal Templates"}),r("button",{class:"close-btn",onClick:n,"aria-label":"Close",children:"Ã—"})]}),o.length===0?r("p",{class:"template-empty",children:"No templates yet. Create one from multiple entries."}):r("ul",{class:"template-list",children:o.map(l=>r("li",{children:[r("button",{class:"template-item",onClick:()=>t(l),children:[r("strong",{children:l.name}),r("span",{children:[l.entries.length," items"]})]}),r("button",{class:"template-delete",onClick:c=>{c.stopPropagation(),a(l.id)},"aria-label":`Delete ${l.name}`,children:"ðŸ—‘ï¸"})]},l.id))})]})})}function Vn(){const[e,t]=y(null),[n,o]=y(!1);B(()=>{const a=l=>{l.preventDefault(),t(l),o(!0)};return window.addEventListener("beforeinstallprompt",a),()=>window.removeEventListener("beforeinstallprompt",a)},[]);async function s(){if(!e)return;e.prompt();const{outcome:a}=await e.userChoice;t(null),o(!1)}return n?r("div",{style:"position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: var(--color-white); padding: var(--space-4); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); z-index: 50; max-width: 320px",children:[r("div",{style:"font-size: 0.875rem; color: var(--color-espresso); margin-bottom: var(--space-3)",children:"Install this app for quick access and offline use"}),r("div",{style:"display: flex; gap: var(--space-2)",children:[r("button",{class:"btn btn--primary btn--sm",onClick:s,children:"Install"}),r("button",{class:"btn btn--secondary btn--sm",onClick:()=>o(!1),children:"Not now"})]})]}):null}function zn(){const[e,t]=y(navigator.onLine);return B(()=>{const n=()=>t(!0),o=()=>t(!1);return window.addEventListener("online",n),window.addEventListener("offline",o),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",o)}},[]),e?null:r("div",{style:"position: fixed; top: var(--space-4); left: 50%; transform: translateX(-50%); background: var(--color-warning); color: var(--color-white); padding: var(--space-2) var(--space-4); border-radius: var(--radius-full); font-size: 0.875rem; z-index: 1000; box-shadow: var(--shadow-md)",children:"Offline Mode"})}function Kn(){const[e,t]=y(de()),[n,o]=y([]),[s,a]=y(vt()),[l,c]=y(Ve(s)),[u,d]=y(!1),[h,i]=y(!1),[p,_]=y(!1),[w,k]=y(!1),[m,f]=y(!1),[g,C]=y(null),[P,E]=y(null),[x,H]=y(!1),[A,v]=y(!1),[D,M]=y(!1),[U,W]=y(!1),b=G(),L=b.length>0,R=b.find(I=>I.id===s),S=n.reduce((I,ge)=>I+(ge.calories||0),0);B(()=>{L&&!s&&k(!0)},[L,s]),B(()=>{wt()&&f(!0)},[]),B(()=>{De();const I=setInterval(De,15*60*1e3);return()=>clearInterval(I)},[]),B(()=>{T()},[e,s]),B(()=>{n.length>0&&l.calories>0&&Gn(s,n,l)},[n,l,s]),B(()=>{c(Ve(s))},[s]);async function T(){const I=await yn(e,s);o(I)}async function z(I){I.id?await pn(I):await ze({...I,date:e,profileId:s}),await T(),d(!1),C(null),W(!0),setTimeout(()=>W(!1),2500)}async function Y(){P&&(await _n(P.id),await T(),E(null))}function me(I){C(I),d(!0)}function Ft(I){an(I,s),c(I),i(!1)}function Dt(){d(!1),C(null)}function Ie(I){X(I),a(I),k(!1),i(!1)}function Et(){X(null),a(null),k(!0)}function xt(){H(!0)}async function At(I){for(const ge of I.entries)await ze({...ge,date:e,profileId:s});await T(),v(!1),W(!0),setTimeout(()=>W(!1),2500)}return r("div",{class:"app",children:[r(zn,{}),r(Vn,{}),r("header",{role:"banner",children:r(Wt,{currentDate:e,onDateChange:t,onSettingsClick:()=>i(!0),onCalendarClick:()=>_(!0),profileName:R==null?void 0:R.name,onProfileClick:Et})}),r("main",{id:"main-content",role:"main",children:[r(Nn,{onClick:()=>d(!0)}),r($n,{entries:n,totalCalories:S,expanded:D,onToggle:()=>M(!D),justLogged:U}),D&&n.length>0&&r(un,{entries:n,onEdit:me,onDelete:E,profileId:s,onShowTemplates:()=>v(!0),compact:!0}),r(Qt,{entries:n,goals:l,profileId:s,date:e,onCelebrationTrigger:xt,justLogged:U}),r(Wn,{profileId:s,profile:R,onDateClick:t})]}),u&&r(Sn,{entry:g,onSave:z,onCancel:Dt,profileId:s}),h&&r(In,{goals:l,onSave:Ft,onClose:()=>i(!1),onDataChange:T,onProfileChange:Ie,activeProfileId:s}),P&&r(et,{title:"Delete Entry",message:`Are you sure you want to delete "${P.name}"?`,confirmText:"Delete",danger:!0,onConfirm:Y,onCancel:()=>E(null)}),p&&r(Bn,{currentDate:e,onSelect:t,onClose:()=>_(!1)}),w&&L&&r(Fe,{onProfileSelect:Ie,onClose:()=>s&&k(!1),isPickerMode:!0}),m&&r(et,{title:"Add Profiles?",message:"Multiple people can track their calories separately on this device. Want to set up profiles?",confirmText:"Add Profiles",onConfirm:()=>{f(!1),k(!0)},onCancel:()=>f(!1)}),x&&r(Hn,{onComplete:()=>H(!1)}),A&&r(Yn,{profileId:s,onSelect:At,onClose:()=>v(!1)})]})}Lt(r(Kn,{}),document.getElementById("app"));
